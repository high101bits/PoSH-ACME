#$ComputerList = @('Win81-06','Win81-05a')
$ComputerList = @('Win81-05a')
$ErrorActionPreference = 'SilentlyContinue'
$PsExecPath = 'C:\Users\Administrator\Documents\GitHub\PoSh-EasyWin\PoSh-EasyWin\Dependencies\Executables\PsExec.exe'
$UserName = 'administrator'
$Password = '1234qwer!@#$QWER'
#$Command  = 'Invoke-Command -scriptblock {Get-Service}'
$Command  = 'tasklist'
$TargetComputer = $ComputerList -join ','

# Executes PSExec.exe using powershell cmdlets, and it converts the string data to an object data format
#(( & $PsExecPath "\\$TargetComputer" -accepteula -nobanner -u $UserName -p $Password powershell $Command) -replace '\s{2,}', ' ').trim(' ') | Where-Object {$_ -notlike '*--*'} | ConvertFrom-Csv -Delimiter ' ' | Export-csv c:\psexec_test.csv -notype
& $PsExecPath "\\$TargetComputer" -accepteula -nobanner -u $UserName -p $Password cmd /c $Command > c:\psexec___1.txt

